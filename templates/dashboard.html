{% extends "base.html" %}
{% set active = "dashboard" %}
{% block title %}Readtube â€” Dashboard{% endblock %}

{% block content %}
<section class="add-url-section">
    <h1>Add a YouTube video, playlist, or channel</h1>
    <form hx-post="/add" hx-target="#article-list" hx-swap="innerHTML" hx-indicator="#add-spinner" class="add-form">
        <input type="text" name="url" placeholder="Paste a YouTube URL..." required autofocus class="url-input" aria-label="YouTube URL">
        <button type="submit" class="btn btn-primary">Add</button>
        <span id="add-spinner" class="htmx-indicator job-spinner"></span>
    </form>
</section>

<section class="filter-section">
    <form class="filter-form" hx-get="/api/articles" hx-target="#article-list" hx-swap="innerHTML" hx-trigger="keyup changed delay:300ms from:#search-input, change from:#status-filter">
        <input type="search" name="q" id="search-input" placeholder="Search articles..." value="{{ search_query or '' }}" class="search-input" aria-label="Search articles">
        <select name="status" id="status-filter" class="status-filter" aria-label="Filter by status">
            <option value="" {% if not status_filter %}selected{% endif %}>All statuses</option>
            <option value="done" {% if status_filter == 'done' %}selected{% endif %}>Done</option>
            <option value="pending" {% if status_filter == 'pending' %}selected{% endif %}>Pending</option>
            <option value="error" {% if status_filter == 'error' %}selected{% endif %}>Error</option>
        </select>
    </form>
</section>

<section class="jobs-section" hx-get="/api/jobs" hx-trigger="every 3s" hx-swap="innerHTML" id="job-status">
    {% include "partials/job_status.html" %}
</section>

<section class="articles-section" hx-get="/api/articles" hx-trigger="every 5s" hx-swap="innerHTML" id="article-list">
    {% include "partials/article_list.html" %}
</section>
{% endblock %}
